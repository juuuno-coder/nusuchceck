<div class="max-w-2xl mx-auto py-8">
  <div class="text-center mb-8">
    <h1 class="text-3xl font-bold text-gray-900">AI 누수 빠른 점검</h1>
    <p class="mt-2 text-gray-600">누수가 의심되는 곳의 사진을 올려주세요. AI가 즉시 분석해 드립니다.</p>
    <span class="inline-block mt-2 px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium">
      무료 · 로그인 불필요
    </span>
  </div>

  <div class="bg-white rounded-2xl shadow-lg p-8" data-controller="photo-upload">
    <%= form_with(model: @inspection, url: leak_inspections_path,
                  html: { multipart: true }, class: "space-y-6") do |f| %>

      <% if @inspection.errors.any? %>
        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
          <p class="text-sm text-red-700 font-medium">입력 오류가 있습니다:</p>
          <ul class="mt-1 text-sm text-red-600 list-disc list-inside">
            <% @inspection.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- 사진 업로드 영역 -->
      <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-blue-400 transition-colors cursor-pointer"
           data-photo-upload-target="dropzone"
           data-action="click->photo-upload#trigger dragover->photo-upload#dragover dragleave->photo-upload#dragleave drop->photo-upload#drop">

        <div data-photo-upload-target="placeholder">
          <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                  d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                  d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          <p class="text-gray-500 mt-3 font-medium">사진을 드래그하거나 클릭하여 업로드</p>
          <p class="text-xs text-gray-400 mt-1">JPG, PNG (최대 5MB)</p>
        </div>

        <img data-photo-upload-target="preview" class="hidden mx-auto max-h-64 rounded-lg shadow-md" alt="미리보기" />

        <%= f.file_field :photo, accept: "image/*", class: "hidden",
              data: { photo_upload_target: "input", action: "change->photo-upload#preview" } %>
      </div>

      <!-- 위치 설명 (선택) -->
      <div>
        <%= f.label :location_description, "어디에서 발견했나요? (선택)",
              class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :location_description,
              placeholder: "예: 거실 천장, 화장실 벽면, 주방 싱크대 아래",
              class: "w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" %>
      </div>

      <!-- 증상 유형 (선택) -->
      <div>
        <%= f.label :symptom_type, "누수 유형 (선택)",
              class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :symptom_type,
              options_for_select([
                ["벽면 누수", "wall_leak"],
                ["천장 누수", "ceiling_leak"],
                ["바닥 누수", "floor_leak"],
                ["배관 누수", "pipe_leak"],
                ["화장실 누수", "toilet_leak"],
                ["외부 누수", "outdoor_leak"]
              ], @inspection.symptom_type),
              { include_blank: "선택해 주세요 (선택사항)" },
              class: "w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" %>
      </div>

      <!-- 제출 버튼 -->
      <div>
        <%= f.submit "AI 분석 시작",
              class: "w-full py-3 bg-blue-600 text-white rounded-xl font-semibold text-lg hover:bg-blue-700 transition cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed opacity-50 cursor-not-allowed",
              disabled: true,
              data: { photo_upload_target: "submitBtn",
                      turbo_submits_with: "🔍 분석 중... AI가 사진을 확인하고 있습니다" } %>
      </div>
    <% end %>
  </div>

  <!-- 안내 사항 -->
  <div class="mt-8 bg-gray-50 rounded-xl p-6">
    <h3 class="font-semibold text-gray-900 mb-3">이런 사진이 좋아요</h3>
    <ul class="space-y-2 text-sm text-gray-600">
      <li class="flex items-start gap-2">
        <span class="text-green-500 mt-0.5">✓</span>
        <span>누수 흔적(물방울, 얼룩, 곰팡이)이 선명하게 보이는 사진</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-green-500 mt-0.5">✓</span>
        <span>밝은 조명에서 가까이 촬영한 사진</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-green-500 mt-0.5">✓</span>
        <span>피해 범위를 알 수 있도록 주변이 함께 나오는 사진</span>
      </li>
    </ul>
  </div>
</div>
