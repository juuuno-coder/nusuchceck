<div class="max-w-2xl mx-auto py-8">
  <div class="mb-6">
    <%= link_to customers_insurance_claim_path(@insurance_claim), class: "text-sm text-blue-600 hover:text-blue-800 flex items-center mb-3" do %>
      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
      돌아가기
    <% end %>
    <h1 class="text-2xl font-bold text-gray-900">✏️ 보험 신청서 수정</h1>
    <p class="text-sm text-gray-500 mt-1"><%= @insurance_claim.claim_number %></p>
  </div>

  <div class="mb-6 bg-gradient-to-br from-yellow-50 to-amber-50 rounded-2xl p-5 border border-yellow-100">
    <p class="text-sm text-gray-800 flex items-start gap-2">
      <svg class="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
      </svg>
      <span>수정 후 <strong>반드시 저장</strong>해주세요. 저장하지 않으면 변경사항이 사라져요</span>
    </p>
  </div>

  <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
    <%= form_with(model: [:customers, @insurance_claim],
                  html: { multipart: true }, class: "space-y-6",
                  data: { controller: "form-validation", action: "submit->form-validation#submit" }) do |f| %>

      <%= render "shared/form_errors", resource: @insurance_claim %>

      <!-- 신청자 정보 -->
      <fieldset class="space-y-4">
        <legend class="text-lg font-semibold text-gray-900 border-b pb-2 w-full flex items-center gap-2">
          <span>👤</span>
          <span>신청자 정보</span>
        </legend>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <%= f.label :applicant_name, "성명 *", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.text_field :applicant_name, required: true,
                  class: input_classes(:text),
                  data: { action: "blur->form-validation#validate" } %>
          </div>
          <div>
            <%= f.label :applicant_phone, "연락처 *", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.text_field :applicant_phone, required: true,
                  class: input_classes(:text),
                  data: { action: "blur->form-validation#validate" } %>
          </div>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <%= f.label :applicant_email, "이메일", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.email_field :applicant_email,
                  class: input_classes(:text),
                  data: { action: "blur->form-validation#validate" } %>
          </div>
          <div>
            <%= f.label :birth_date, "생년월일", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.date_field :birth_date, class: input_classes(:text) %>
          </div>
        </div>
      </fieldset>

      <!-- 사고 정보 -->
      <fieldset class="space-y-4">
        <legend class="text-lg font-semibold text-gray-900 border-b pb-2 w-full flex items-center gap-2">
          <span>🚨</span>
          <span>사고 정보</span>
        </legend>
        <div>
          <%= f.label :incident_date, "사고 발생일 *", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.date_field :incident_date, required: true, class: input_classes(:text) %>
        </div>
        <div>
          <%= f.label :incident_address, "사고 장소 *", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.text_field :incident_address, required: true,
                class: input_classes(:text),
                data: { action: "blur->form-validation#validate" } %>
        </div>
        <div>
          <%= f.label :incident_detail_address, "상세 주소", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.text_field :incident_detail_address, class: input_classes(:text) %>
        </div>
        <div>
          <%= f.label :damage_type, "피해 유형", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.select :damage_type,
                options_for_select([
                  ["재산 피해", "property_damage"],
                  ["인적 피해", "personal_injury"],
                  ["재산 + 인적 피해", "both"]
                ], @insurance_claim.damage_type),
                { include_blank: "선택해 주세요" },
                class: input_classes(:select) %>
        </div>
        <div>
          <%= f.label :estimated_damage_amount, "예상 피해 금액 (원)", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.number_field :estimated_damage_amount, min: 0, step: 10000,
                class: input_classes(:text) %>
        </div>
        <div>
          <%= f.label :incident_description, "사고 내용 상세 *", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.text_area :incident_description, rows: 5, required: true,
                class: input_classes(:textarea),
                data: { action: "blur->form-validation#validate" } %>
        </div>
      </fieldset>

      <!-- 보험 정보 -->
      <fieldset class="space-y-4">
        <legend class="text-lg font-semibold text-gray-900 border-b pb-2 w-full flex items-center gap-2">
          <span>🛡️</span>
          <span>보험 정보</span>
        </legend>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <%= f.label :insurance_company, "보험사", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.select :insurance_company,
                  options_for_select(
                    ["삼성화재", "현대해상", "DB손해보험", "KB손해보험",
                     "메리츠화재", "한화손해보험", "흥국화재", "기타"],
                    @insurance_claim.insurance_company
                  ),
                  { include_blank: "선택해 주세요" },
                  class: input_classes(:select) %>
          </div>
          <div>
            <%= f.label :policy_number, "증권번호", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.text_field :policy_number, class: input_classes(:text) %>
          </div>
        </div>
      </fieldset>

      <!-- 피해자 정보 -->
      <fieldset class="space-y-4">
        <legend class="text-lg font-semibold text-gray-900 border-b pb-2 w-full flex items-center gap-2">
          <span>👥</span>
          <span>피해자 정보</span>
          <span class="text-xs font-normal text-gray-500">(선택사항)</span>
        </legend>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <%= f.label :victim_name, "피해자 성명", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.text_field :victim_name, class: input_classes(:text) %>
          </div>
          <div>
            <%= f.label :victim_phone, "피해자 연락처", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.text_field :victim_phone, class: input_classes(:text) %>
          </div>
        </div>
        <div>
          <%= f.label :victim_address, "피해자 주소", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.text_area :victim_address, rows: 2, class: input_classes(:textarea) %>
        </div>
      </fieldset>

      <!-- 증빙 서류 -->
      <fieldset class="space-y-4">
        <legend class="text-lg font-semibold text-gray-900 border-b pb-2 w-full flex items-center gap-2">
          <span>📎</span>
          <span>증빙 서류 추가</span>
        </legend>
        <p class="text-xs text-gray-600">새로운 서류를 추가할 수 있어요. 기존 서류는 유지돼요</p>
        <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-blue-400 transition">
          <%= f.file_field :supporting_documents, multiple: true, accept: "image/*,application/pdf",
                class: "w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700 file:cursor-pointer cursor-pointer" %>
          <p class="mt-2 text-xs text-gray-500">사진, PDF 파일 · 최대 10개 · 각 파일당 10MB 이하</p>
        </div>
      </fieldset>

      <div class="pt-6 border-t-2 border-gray-200">
        <div class="flex items-center justify-end gap-3">
          <%= link_to "취소", customers_insurance_claim_path(@insurance_claim),
                class: "px-5 py-2.5 rounded-lg font-medium text-gray-700 hover:bg-gray-100 transition" %>
          <%= f.submit "💾 저장하기",
                class: "px-8 py-3 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition shadow-lg hover:shadow-xl" %>
        </div>
        <p class="text-xs text-center text-gray-500 mt-3">저장 후에도 언제든지 다시 수정할 수 있어요</p>
      </div>
    <% end %>
  </div>
</div>
